# GCPç§»è¡Œæ™‚ã«å¼•ãç¶™ãã¹ããƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿

## ğŸ“Š æ¦‚è¦

Supabase â†’ GCP Cloud SQL PostgreSQL ç§»è¡Œæ™‚ã«ã€ä»¥ä¸‹ã®ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºå®Ÿã«ç§»è¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

## ğŸ‹ï¸ ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ï¼ˆ18ä»¶ï¼‰

**å…¨ã¦ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ãƒ¼ã‚¿**ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã‚‹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼š

- å£è¼ªç­‹è¨“ç·´ï¼ˆç­‹åŠ›è¨“ç·´ï¼‰
- ã€ã‚ã€ã®å£ã®ç¢ºèªï¼ˆåŸºç¤è¨“ç·´ï¼‰
- ã‚ã„ã†ã¹ä½“æ“ï¼ˆç·åˆè¨“ç·´ï¼‰
- èˆŒå°å¸¯ä¼¸ã°ã—ï¼ˆæŸ”è»Ÿæ€§ï¼‰
- å£å”‡ã®ç·Šå¼µé™¤å»ï¼ˆãƒªãƒ©ãƒƒã‚¯ã‚¹ï¼‰
- ã‚¹ãƒãƒƒãƒˆã®ä½ç½®ç¢ºèªï¼ˆèˆŒä½ç½®ï¼‰
- å¸ã„ä¸Šã’ãŒã§ããªã„å ´åˆï¼ˆèˆŒè¨“ç·´ï¼‰
- å£å”‡ã‚’ãªãã‚‹ï¼ˆèˆŒè¨“ç·´ï¼‰
- ã‚¿ãƒ©ä½“æ“ï¼ˆç·åˆè¨“ç·´ï¼‰
- æ¯å¹ãã‹ã‘ï¼ˆå‘¼å¸è¨“ç·´ï¼‰
- ä»–8ä»¶

**ãƒ†ãƒ¼ãƒ–ãƒ«**: `trainings`

## ğŸ“‹ å•è¨ºç¥¨ãƒ‡ãƒ¼ã‚¿ï¼ˆ3ä»¶ + 249è³ªå•ï¼‰

- æ¨™æº–å•è¨ºè¡¨
- ç¿’æ…£ãƒã‚§ãƒƒã‚¯è¡¨
- ç°¡æ˜“å•è¨ºè¡¨

**ãƒ†ãƒ¼ãƒ–ãƒ«**: `questionnaires`, `questionnaire_questions`

## ğŸ“¬ é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆ5ä»¶ï¼‰

- äºˆç´„ç¢ºå®šé€šçŸ¥ï¼ˆappointment_reminderï¼‰
- å®šæœŸæ¤œè¨ºãƒªãƒã‚¤ãƒ³ãƒ‰ï¼ˆperiodic_checkupï¼‰
- æ²»ç™‚ãƒªãƒã‚¤ãƒ³ãƒ‰ï¼ˆtreatment_reminderï¼‰
- äºˆç´„ãƒªãƒã‚¤ãƒ³ãƒ‰ï¼ˆappointment_reminderï¼‰
- LINEé€£æºå®Œäº†é€šçŸ¥ï¼ˆcustomï¼‰

**ãƒ†ãƒ¼ãƒ–ãƒ«**: `notification_templates`

## ğŸ“ ãƒ¡ãƒ¢ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆ4ä»¶ï¼‰

ã‚¯ãƒªãƒ‹ãƒƒã‚¯ã§ä½¿ç”¨ã™ã‚‹å®šå‹ãƒ¡ãƒ¢ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

**ãƒ†ãƒ¼ãƒ–ãƒ«**: `memo_templates`

## ğŸ’Š æ²»ç™‚ã‚³ãƒ¼ãƒ‰ï¼ˆ7ä»¶ï¼‰

ä¿é™ºç‚¹æ•°è¨ˆç®—ãªã©ã§ä½¿ç”¨ã™ã‚‹æ²»ç™‚ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿

**ãƒ†ãƒ¼ãƒ–ãƒ«**: `treatment_codes`

---

## âœ… ç§»è¡Œæ–¹æ³•

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: pg_dump/pg_restoreï¼ˆæ¨å¥¨ï¼‰

```bash
# Supabaseã‹ã‚‰ãƒ€ãƒ³ãƒ—
pg_dump -h localhost -p 54322 -U postgres -d postgres \
  --data-only \
  --table=trainings \
  --table=questionnaires \
  --table=questionnaire_questions \
  --table=notification_templates \
  --table=memo_templates \
  --table=treatment_codes \
  > master_data.sql

# GCP Cloud SQLã«ãƒªã‚¹ãƒˆã‚¢
psql -h <GCP_HOST> -U postgres -d postgres < master_data.sql
```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: Prisma Seed

`prisma/seed.ts`ã‚’ä½œæˆã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³3: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›´æ¥ã‚³ãƒ”ãƒ¼

```sql
-- Supabaseã‹ã‚‰å–å¾—
COPY (SELECT * FROM trainings WHERE is_default = true) TO '/tmp/trainings.csv' CSV HEADER;

-- GCPã«æŠ•å…¥
COPY trainings FROM '/tmp/trainings.csv' CSV HEADER;
```

---

## âš ï¸ æ³¨æ„äº‹é …

1. **clinic_idä¾å­˜**: ä¸€éƒ¨ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¯`clinic_id`å¤–éƒ¨ã‚­ãƒ¼ã‚’æŒã¤ãŸã‚ã€ã‚¯ãƒªãƒ‹ãƒƒã‚¯ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å…ˆã«ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

2. **UUIDä¸€è²«æ€§**: IDãŒUUIDã®å ´åˆã€å‚ç…§æ•´åˆæ€§ã‚’ä¿ã¤ãŸã‚åŒã˜IDã§ç§»è¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

3. **is_default/is_system_template**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è­˜åˆ¥ã™ã‚‹ãƒ•ãƒ©ã‚°ã‚’ç¢ºèªã—ã¦ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã™

4. **created_at/updated_at**: ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚‚ç§»è¡Œã™ã‚‹ã¨å±¥æ­´ãŒä¿æŒã•ã‚Œã¾ã™
